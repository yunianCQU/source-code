The source code is a matlab script, which runs in the COMSOL LiveLink for MATLAB environment. The applicable software version is comsol --version> 5.6, matlab --version> 2019.

In the Section "Numerical example of layered a model", we used the layered model for comparison.
The electrical model, physical field control equations, mesh division, and finite element numerical calculation are all in the script of the "example_ layered model" file. 
There are 1 script ("layered_model.m") in the folder.

In the Section "Numerical example of an outcrop block model", we used the outcrop block model for comparison.
The electrical model, physical field control equations, mesh division, and finite element numerical calculation are all in the script of the "example_ outcrop block model" file.
There are 2 scripts in the folder, "outcrop_block_model.m" and "outcrop_block_model_Tet3.m". These two scripts contain different grids (Table 2 in the manuscript contains 4 sets of grids) of the magnetotelluric forward calculation process.
The script "outcrop_block_model.m" contains the magnetotelluric forward calculation process of "Hybrid grids","Tetrahedr grid1", "Tetrahedr grid2" .
The script "outcrop_block_model_Tet3.m" contains "Tetrahedr grid3".


In the Section "Numerical example of a buried block model", we used the buried block model for comparison.
The electrical model, physical field control equations, mesh division, and finite element numerical calculation are all in the script of the "example_ buried block model" file.
There are 2 scripts in the folder, "buried_block_model_Hyb.m" and "buried_block_model_Tet.m". These two scripts contain different grids (Table 3 in the manuscript contains 4 sets of grids) of the magnetotelluric forward calculation process.
The script "buried_block_model_Hyb.m" contains the magnetotelluric forward calculation process of "Hybrid grids".
The script "buried_block_model_Tet.m" contains "Tetrahedr grid1", "Tetrahedr grid2", "Tetrahedr grid3".


We run the 'test.m' script, call the scripts in each subfolder, and save the required data in the manuscript.
The saved data is explained as follows (保存的数据说明如下):
==========================
Layered model data observation
==========================
Data observation format：

              | x | y | z | freq1_rho | freq1_phi | freq2_rho | freq2_phi |...
station 1

==========================
 buried block model data observation
==========================
Data observation format：
line A

               | x | y | z | rho_xy | phi_xy | rho_yx | phi_xy |
station 1
station 2
station 3
...

line B

               | x | y | z | rho_xy | phi_xy | rho_yx | phi_xy |
station 1
station 2
station 3
...
==========================
buried block model data observation
==========================
Data observation format：

               | x | y | z | rho_xy | phi_xy | rho_yx | phi_xy |
station 1
station 2
station 3
...